---
title: "Athens2025_Final"
output: html_document
---

```{r}
#Import libraries
library(readxl)
library(dplyr)
library(ggplot2)

```



```{r}

# Load annual region data
annual_region_encounters <- read_excel("KHSM Encounters (OFO) fy25m11.xlsx", sheet = "Annual Region")
glimpse(annual_region_encounters)

colnames(annual_region_encounters)

# Clean and filter for 2004–2014
spaghetti_annual_region_encounters <- annual_region_encounters %>%
  rename(
    Year = `Fiscal\r\nYear`,
    Region = `Region`, 
    Encounters = `Quantity`
  ) %>%
  filter(Year >= 2004 & Year <= 2014)


top_regions <- spaghetti_annual_region_encounters %>%
  group_by(Region) %>%
  summarise(Total = sum(Encounters)) %>%
  arrange(desc(Total)) %>%
  slice_head(n = 5)

spaghetti_annual_region_encounters_filtered <- spaghetti_annual_region_encounters %>%
  filter(Region %in% top_regions$Region)


print(spaghetti_annual_region_encounters_filtered)
ggplot(spaghetti_annual_region_encounters, aes(x = Year, y = Encounters, color = Region)) +
  geom_line(size = 1) +
  geom_point(size = 2) +
  labs(
    title = "Spaghetti Plot: Border Encounters by Region (2004–2014)",
    x = "Year",
    y = "Encounters"
  ) +
  theme_minimal() +
  theme(
    legend.position = "right",
    plot.title = element_text(face = "bold", size = 14)
  )
```








```{r}

# Load annual region data
annual_region_encounters <- read_excel("KHSM Encounters (OFO) fy25m11.xlsx", sheet = "Annual Region")
glimpse(annual_region_encounters)

colnames(annual_region_encounters)

# Clean and filter for 2004–2014
spaghetti_annual_region_encounters <- annual_region_encounters %>%
  rename(
    Year = `Fiscal\r\nYear`,
    Region = `Region`, 
    Encounters = `Quantity`
  ) %>%
  filter(Year >= 2015 & Year <= 2025)


top_regions <- spaghetti_annual_region_encounters %>%
  group_by(Region) %>%
  summarise(Total = sum(Encounters)) %>%
  arrange(desc(Total)) %>%
  slice_head(n = 5)

spaghetti_annual_region_encounters_filtered <- spaghetti_annual_region_encounters %>%
  filter(Region %in% top_regions$Region)


print(spaghetti_annual_region_encounters_filtered)
ggplot(spaghetti_annual_region_encounters, aes(x = Year, y = Encounters, color = Region)) +
  geom_line(size = 1) +
  geom_point(size = 2) +
  labs(
    title = "Spaghetti Plot: Border Encounters by Region (2015–2025)",
    x = "Year",
    y = "Encounters"
  ) +
  theme_minimal() +
  theme(
    legend.position = "right",
    plot.title = element_text(face = "bold", size = 14)
  )
```

